<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Requerimientos - REPSE</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      background: linear-gradient(135deg, #ff6a00, #ff007b, #6600ff);
      background-size: 300% 300%;
      animation: gradientShift 10s ease infinite;
      color:#fff;
      padding:24px;
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .card{
      width: 720px;
      max-width: 100%;
      background: rgba(255,255,255,0.95);
      color:#333;
      border-radius:14px;
      padding:22px;
      box-shadow:0 10px 24px rgba(0,0,0,0.25);
    }
    .hint{ font-size: 0.9rem; color:#666; }
  </style>
</head>
<body>

<div class="card">
  <h3 class="mb-2">Requerimientos</h3>
  <p class="hint mb-3">Captura el mes/fecha y tus pedidos. Después podrás subir la documentación por pedido.</p>

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="alert alert-warning">
        {% for m in messages %}{{ m }}<br>{% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <form method="POST" id="reqForm">
    <div class="row g-2">
      <div class="col-md-5">
        <label class="form-label">Mes</label>
        <select name="mes" class="form-select" required>
          <option value="" selected disabled>Selecciona…</option>
          {% for m in meses %}
            <option value="{{ m }}">{{ m }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Fecha</label>
        <input type="date" name="fecha" class="form-control" required>
      </div>
      <div class="col-md-3">
        <label class="form-label">Cantidad de pedidos</label>
        <input type="number" min="1" max="50" name="cantidad" id="cantidad" class="form-control" required>
      </div>
    </div>

    <hr class="my-3">

    <div id="pedidosContainer"></div>

    <button class="btn btn-primary mt-2" type="submit">Guardar requerimientos</button>
    <a class="btn btn-outline-secondary mt-2" href="{{ url_for('logout') }}">Cerrar sesión</a>
  </form>
</div>

<script>
  const cantidad = document.getElementById('cantidad');
  const cont = document.getElementById('pedidosContainer');

  function renderInputs(n){
    cont.innerHTML = '';
    for(let i=1;i<=n;i++){
      const row = document.createElement('div');
      row.className = 'mb-2';
      row.innerHTML = `
        <label class="form-label">No. Pedido ${i}</label>
        <input type="text" class="form-control" name="pedido_${i}" placeholder="Ej: 123456" required>
      `;
      cont.appendChild(row);
    }
  }

  cantidad.addEventListener('input', () => {
    const n = parseInt(cantidad.value || '0', 10);
    if(n > 0) renderInputs(n);
    else cont.innerHTML = '';
  });
</script>

</body>
</html>
